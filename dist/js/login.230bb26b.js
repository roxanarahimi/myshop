"use strict";(self["webpackChunkmyshop"]=self["webpackChunkmyshop"]||[]).push([[966],{3096:function(e,l,t){t.r(l),t.d(l,{default:function(){return S}});var o=t(6768),n=t(5130),i=t(4232);const d={class:"row p-0 m-0 w-100 d-grid",style:{"min-height":"500px !important"}},r={class:"col-10 col-lg-3 p-0 align-self-center mx-auto"},a={class:"card w-100",style:{"border-color":"#eeeeee !important","border-radius":"2px"}},s={class:"card-body p-0"},c={key:0,class:"mobile-form"},u={class:"small invalid-feedback d-block"},m={key:1,id:"verify-mobile"},v={class:"col-12 d-flex justify-content-between px-3"},b={id:"time"},p={class:"d-flex"},k={class:"small invalid-feedback d-block",dir:"rtl"},y={key:0};function f(e,l,t,f,g,h){return(0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("div",r,[(0,o.Lk)("div",a,[(0,o.Lk)("div",s,[f.mobileValidated?((0,o.uX)(),(0,o.CE)("div",m,[l[14]||(l[14]=(0,o.Lk)("p",{class:"p-3 small"},"کد تایید 4 رقمی برای شما پیامک شد. لطفا کد را وارد کنید.",-1)),(0,o.Lk)("div",v,[(0,o.Lk)("small",{disabled:"",id:"resend",onClick:l[2]||(l[2]=(...l)=>e.resend&&e.resend(...l)),class:"text-black-50"},[l[12]||(l[12]=(0,o.eW)("ارسال مجدد کد ",-1)),(0,o.Lk)("span",b,(0,i.v_)(f.time),1)]),(0,o.Lk)("small",{onClick:l[3]||(l[3]=(...l)=>e.editNumber&&e.editNumber(...l)),class:"text-black-50 cursor"},"ویرایش شماره")]),(0,o.Lk)("form",{class:"p-3",dir:"ltr",onReset:l[8]||(l[8]=(...e)=>f.focus1stInput&&f.focus1stInput(...e)),onSubmit:l[9]||(l[9]=(0,n.D$)((...e)=>f.checkCode&&f.checkCode(...e),["prevent"]))},[(0,o.Lk)("div",p,[(0,o.Lk)("input",{type:"number",onInput:l[4]||(l[4]=e=>f.inputHandle("1")),class:(0,i.C4)(["code me-2 form-control text-center rounded rounded-1",{"border-danger":f.invalidCode}]),min:"0",max:"9",minlength:"1",maxlength:"1",id:"code1"},null,34),(0,o.Lk)("input",{type:"number",onInput:l[5]||(l[5]=e=>f.inputHandle("2")),class:(0,i.C4)(["code me-2 form-control text-center rounded rounded-1",{"border-danger":f.invalidCode}]),min:"0",max:"9",minlength:"1",maxlength:"1",id:"code2"},null,34),(0,o.Lk)("input",{type:"number",onInput:l[6]||(l[6]=e=>f.inputHandle("3")),class:(0,i.C4)(["code me-2 form-control text-center rounded rounded-1",{"border-danger":f.invalidCode}]),min:"0",max:"9",minlength:"1",maxlength:"1",id:"code3"},null,34),(0,o.Lk)("input",{type:"number",onInput:l[7]||(l[7]=e=>f.inputHandle("4")),class:(0,i.C4)(["code form-control text-center rounded rounded-1",{"border-danger":f.invalidCode}]),min:"0",max:"9",minlength:"1",maxlength:"1",id:"code4"},null,34)]),(0,o.Lk)("ul",k,[f.invalidCode?((0,o.uX)(),(0,o.CE)("li",y,[...l[13]||(l[13]=[(0,o.eW)("کد وارد شده اشتباه است ",-1),(0,o.Lk)("button",{class:"btn-none",type:"reset"},"پاک‌کن",-1)])])):(0,o.Q3)("",!0)])],32),l[15]||(l[15]=(0,o.Lk)("button",{class:"submit-btn bg-primary text-light",type:"submit"},"ورود",-1))])):((0,o.uX)(),(0,o.CE)("div",c,[l[11]||(l[11]=(0,o.Lk)("p",{class:"p-3 small"},"برای ورود به سایت، شماره موبایل خود را وارد کنید.",-1)),(0,o.Lk)("form",{class:"form-floating p-3",dir:"ltr",onSubmit:l[0]||(l[0]=(0,n.D$)((...e)=>f.validateMobile&&f.validateMobile(...e),["prevent"]))},[(0,o.Lk)("input",{type:"number",class:(0,i.C4)(["form-control en rounded rounded-1",{"is-invalid":f.invalidMobile}]),id:"mobile"},null,2),l[10]||(l[10]=(0,o.Lk)("label",{for:"mobile",class:"form-label text-end"},"شماره موبایل",-1))],32),(0,o.Lk)("ul",u,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f.errors,e=>((0,o.uX)(),(0,o.CE)("li",null,(0,i.v_)(e),1))),256))]),(0,o.Lk)("button",{class:"submit-btn bg-primary text-light",onClick:l[1]||(l[1]=(...e)=>f.validateMobile&&f.validateMobile(...e))},"دریافت کد تایید")]))])])])])}t(4114),t(8111),t(7588),t(3110);var g=t(144),h=t(7293),L={name:"Login",setup(){const e=(0,g.KR)(!1),l=(0,g.KR)(),t=(0,g.KR)(!1),n=(0,g.KR)([]);(0,o.sV)(()=>{document.querySelector("#mobile").focus()});const i=()=>{n.value=[];let e=document.querySelector("#mobile").value;document.querySelector("#mobile").classList?.remove("is-invalid"),e.startsWith("09")||n.value.push("شماره موبایل باید با 09 شروع شود"),11!==e.length&&n.value.push("شماره موبایل باید 11 رقم باشد"),n.value.length?document.querySelector("#mobile").classList.add("is-invalid"):(document.querySelector("#mobile").classList.add("is-valid"),l.value=!0,localStorage.setItem("mobile",e),c(e))},d=h.A.setup().url,r=(0,g.KR)(document.getElementById("mobile")?.value),a=(0,g.KR)(59),s=()=>{a.value=59,setInterval(()=>{a.value>0&&(a.value=a.value-1)},1e3)},c=e=>{axios.post(d+"/api/user/otp",{mobile:e.value}).then(e=>{setTimeout(()=>{s(),v()},200)}).catch(e=>{console.error(e)})},u=e=>{document.querySelector("#code"+e).classList.remove("is-invalid");let l=document.querySelector("#code"+e).value;if(l<0||l>9)document.querySelector("#code"+e).classList.add("is-invalid");else if(console.log(l),""!=l&&l<=9&&l>=0){let l=parseInt(e)+1;document.querySelector("#code"+l)?.focus()}let t=document.querySelector("#code1").value+document.querySelector("#code3").value+document.querySelector("#code3").value+document.querySelector("#code4").value;m(t)},m=e=>{4===e.length?axios.post(d+"/api/user/verify",{code:e}).then(e=>{setTimeout(()=>{t.value=!1,document.querySelectorAll(".code").forEach(e=>{e.classList.remove("is-invalid"),e.classList.add("is-valid")}),localStorage.setItem("user",JSON.stringify(e.user)),setTimeout(()=>{window.location="/profile"},2e3)},1e3)}).catch(e=>{t.value=!0,console.error(e)}):t.value=!1},v=()=>{console.log(document.querySelector("#code1")),document.querySelector("#code1").focus(),t.value=!1};return{invalidMobile:e,validateMobile:i,errors:n,sendOtp:c,invalidCode:t,inputHandle:u,checkCode:m,focus1stInput:v,mobileValidated:l,url:d,time:a,mobile:r}}},x=t(1241);const C=(0,x.A)(L,[["render",f]]);var S=C}}]);
//# sourceMappingURL=login.230bb26b.js.map